r_outlier <- data.frame(r_outlier)
colnames(r_outlier) <- c("re_china_average")
r_outlier$re_seoul_average <- ifelse(finedust_without_na$seoul_average < 5 | finedust_without_na$seoul_average > 98, NA, finedust_without_na$seoul_average)
boxplot(r_outlier)
r_outlier <- ifelse(finedust_without_na$china_average < 13 | finedust_without_na$china_average > 160, NA, finedust_without_na$china_average)
r_outlier <- data.frame(r_outlier)
colnames(r_outlier) <- c("re_china_average")
r_outlier$re_seoul_average <- ifelse(finedust_without_na$seoul_average < 5 | finedust_without_na$seoul_average > 98, NA, finedust_without_na$seoul_average)
boxplot(r_outlier)
r_outlier <- ifelse(finedust_without_na$china_average < 13 | finedust_without_na$china_average > 170, NA, finedust_without_na$china_average)
r_outlier <- data.frame(r_outlier)
colnames(r_outlier) <- c("re_china_average")
r_outlier$re_seoul_average <- ifelse(finedust_without_na$seoul_average < 5 | finedust_without_na$seoul_average > 98, NA, finedust_without_na$seoul_average)
boxplot(r_outlier)
r_outlier <- ifelse(finedust_without_na$china_average < 13 | finedust_without_na$china_average > 165, NA, finedust_without_na$china_average)
r_outlier <- data.frame(r_outlier)
colnames(r_outlier) <- c("re_china_average")
r_outlier$re_seoul_average <- ifelse(finedust_without_na$seoul_average < 5 | finedust_without_na$seoul_average > 98, NA, finedust_without_na$seoul_average)
boxplot(r_outlier)
r_outlier <- ifelse(finedust_without_na$china_average < 13 | finedust_without_na$china_average > 163, NA, finedust_without_na$china_average)
r_outlier <- data.frame(r_outlier)
colnames(r_outlier) <- c("re_china_average")
r_outlier$re_seoul_average <- ifelse(finedust_without_na$seoul_average < 5 | finedust_without_na$seoul_average > 98, NA, finedust_without_na$seoul_average)
boxplot(r_outlier)
r_outlier <- ifelse(finedust_without_na$china_average < 13 | finedust_without_na$china_average > 162, NA, finedust_without_na$china_average)
r_outlier <- data.frame(r_outlier)
colnames(r_outlier) <- c("re_china_average")
r_outlier$re_seoul_average <- ifelse(finedust_without_na$seoul_average < 5 | finedust_without_na$seoul_average > 98, NA, finedust_without_na$seoul_average)
boxplot(r_outlier)
plot(r_outlier)
r_outlier <- ifelse(finedust_without_na$china_average < 13 | finedust_without_na$china_average > 174, NA, finedust_without_na$china_average)
r_outlier <- data.frame(r_outlier)
colnames(r_outlier) <- c("re_china_average")
r_outlier$re_seoul_average <- ifelse(finedust_without_na$seoul_average < 5 | finedust_without_na$seoul_average > 98, NA, finedust_without_na$seoul_average)
boxplot(r_outlier)
plot(r_outlier)
r_outlier <- ifelse(finedust_without_na$china_average < 13.61111 | finedust_without_na$china_average > 174.27778, NA, finedust_without_na$china_average)
r_outlier <- data.frame(r_outlier)
colnames(r_outlier) <- c("re_china_average")
r_outlier$re_seoul_average <- ifelse(finedust_without_na$seoul_average < 5 | finedust_without_na$seoul_average > 98, NA, finedust_without_na$seoul_average)
boxplot(r_outlier)
plot(r_outlier)
cor(finedust$china_average, finedust$seoul_average, method=c("pearson"), use=("complete.obs"))
View(finedust)
# correlation analysis
finedust_without_na <- na.omit(finedust)
sum(is.na(finedust_without_na))
cor(finedust$china_average, finedust$seoul_average, method=c("pearson"), use=("complete.obs"))
# find outlier
plot(finedust_without_na)
# find outlier
plot(finedust_without_na$china_average, finedust_without_na$seoul_average)
# remove outlier
boxplot(finedust_without_na)$stats # return statistic on boxplot
# remove outlier
boxplot(finedust_without_na$china_average, finedust_without_na$seoul_average)$stats # return statistic on boxplot
r_outlier <- ifelse(finedust_without_na$china_average < 13.61111 | finedust_without_na$china_average > 174.27778, NA, finedust_without_na$china_average)
r_outlier <- data.frame(r_outlier)
colnames(r_outlier) <- c("re_china_average")
r_outlier$re_seoul_average <- ifelse(finedust_without_na$seoul_average < 5 | finedust_without_na$seoul_average > 98, NA, finedust_without_na$seoul_average)
boxplot(r_outlier)
plot(r_outlier)
#visualization(finedust_with_na로 활용)
finedust_without_na$re_china_average <- r_outlier <- ifelse(finedust_without_na$china_average < 13.61111 | finedust_without_na$china_average > 174.27778, NA, finedust_without_na$china_average)
finedust_without_na%re_seoul_average <- ifelse(finedust_without_na$seoul_average < 5 | finedust_without_na$seoul_average > 98, NA, finedust_without_na$seoul_average)
finedust_without_na$re_seoul_average <- ifelse(finedust_without_na$seoul_average < 5 | finedust_without_na$seoul_average > 98, NA, finedust_without_na$seoul_average)
boxplot(finedust_without_na$re_china_average, finedust_without_na$re_seoul_average)
plot(finedust_without_na$re_china_average, finedust_without_na$re_seoul_average)
#visualization(finedust_with_na로 활용)
plot(finedust_with_na$re_china_average, type='o', col='red', ylim=c(1, 200))
#visualization(finedust_with_na로 활용)
plot(finedust_without_na$re_china_average, type='o', col='red', ylim=c(1, 200))
plot(finedust_without_na$re_seoul_average, type='o'm col='blue')
plot(finedust_without_na$re_seoul_average, type='o', col='blue')
lines(finedust_without_na$re_seoul_average, type='o', col='blue')
#visualization(finedust_with_na로 활용)
plot(finedust_without_na$re_china_average, type='o', col='red', ylim=c(1, 200))
lines(finedust_without_na$re_seoul_average, type='o', col='blue')
#visualization(finedust_with_na로 활용)
plot(finedust_without_na$re_china_average, type='o', col='red', ylim=c(1, 200), xlab='date', ylab='fine dust', main='graph for fine dust over 7 years')
lines(finedust_without_na$re_seoul_average, type='o', col='blue')
# visualization
rm(r_outlier)
as.Date(finedust_without_na$date, "%Y-%m-%d")
as.Date(finedust_without_na$date, format="%Y-%m-%d")
as.Date(finedust_without_na$date, format="%Y/%m/%d")
finedust_without_na$date <- as.Date(finedust_without_na$date, format="%Y/%m/%d")
data.frame(finedust_without_na, finedust_without_na$date.year)
data.frame(finedust_without_na, year(finedust_without_na$date))
year(finedust_without_na$date)
install.packages('lubridate')
library('lubridate')
data.frame(finedust_without_na, year(finedust_without_na$date))
ggplot(finedust_without_na$re_china_average, aes(x = year, y = fine dust, group=year(finedust_without_na$date)))
ggplot(data = finedust_without_na$re_china_average, aes(x = year, y = fine dust, group=year(finedust_without_na$date, color = red)))
ggplot(data = finedust_without_na$re_china_average, aes(x = year, y = fine dust, group=year(finedust_without_na$date, color = 'red')))
ggplot(data = finedust_without_na$re_china_average, aes(x = 'year', y = 'fine dust', group=year(finedust_without_na$date, color = 'red')))
install.packages("ggplot2")
library('ggplot')
library('ggplot2')
install.packages('ggplot')
library('ggplot')
ggplot(data = finedust_without_na$re_china_average, aes(x = 'year', y = 'fine dust', group=year(finedust_without_na$date, color = 'red')))
ggplot2(data = finedust_without_na$re_china_average, aes(x = 'year', y = 'fine dust', group=year(finedust_without_na$date, color = 'red')))
ggplot2(data = finedust_without_na$re_china_average, aes(x = 'year', y = 'fine dust', group=year(finedust_without_na$date, color = 'red')))
library('ggplot2')
install.packages('ggplot2')
install.packages("ggplot2")
library('ggplot2')
ggplot2(data = finedust_without_na$re_china_average, aes(x = 'year', y = 'fine dust', group=year(finedust_without_na$date, color = 'red')))
qplot(finedust_without_na$re_china_average, finedust_without_na$re_seoul_average, geom='line')
qplot(finedust_without_na$year(date), finedust_without_na$re_china_average, geom='line')
qplot(finedust_without_na$date, finedust_without_na$re_china_average, geom='line')
qplot(finedust_without_na$date, finedust_without_na$re_china_average, aex(x='date', y=fine dust) geom='line')+geom_line(color='red')
qplot(finedust_without_na$date, finedust_without_na$re_china_average, aex(x='date', y=finedust) geom='line')+geom_line(color='red')
qplot(finedust_without_na$date, finedust_without_na$re_china_average, aex(x='date', y=fine dust), geom='line')+geom_line(color='red')
qplot(finedust_without_na$date, finedust_without_na$re_china_average, aex(x='date', y=finedust), geom='line')+geom_line(color='red')
qplot(finedust_without_na$date, finedust_without_na$re_china_average, aex(x='date', y='fine dust'), geom='line')+geom_line(color='red')
qplot(finedust_without_na$date, finedust_without_na$re_china_average, aes(x='date', y='fine dust'), geom='line')+geom_line(color='red')
qplot(finedust_without_na$year(date), finedust_without_na$re_china_average, aes(x='date', y='fine dust'), geom='line')+geom_line(color='red')
ggplot(data=finedust_without_na$re_china_average, aes(x='year', y='fine dust', group=year(date)))+geom_line()
finedust_without_na$year <- year(date)
library('lubridate')
finedust_without_na$year <- year(date)
finedust_without_na$year <- year(finedust_without_na$date)
ggplot(data=finedust_without_na$re_china_average, aes(x='year', y='fine dust', group=year(date)))+geom_line()
ggplot(data=finedust_without_na$re_china_average, aes(x='year', y='fine dust', group=year))+geom_line()
finedust_without_na$year <- year(finedust_without_na$date)
year(finedust_without_na$date)
finedust_without_na$year <- year(finedust_without_na$date)
finedust_d<- year(finedust_without_na$date)
finedust_d$year <- data.frame(fine_dust)
finedust_d$year <- data.frame(finedust_d)
View(finedust_d)
finedust_without_na$year <- year(finedust_without_na$date)
finedust_d <- year(finedust_without_na$date)
finedust_d <- data.frame(finedust_d)
View(finedust_d)
finedust_d$month <- month(finedust_without_na$date)
View(finedust_without_na)
finedust_without_na$month <- month(finedust_without_na$date)
View(finedust_without_na)
rm(finedust_d)
install.packages('ggplot2')
library('ggplot2')
ggplot(data=finedust_without_na$re_china_average, aes(x='year', y='fine dust', group=year))+geom_line()
ggplot(data=finedust_without_na$re_china_average, aes(x='year', y='fine dust', group=year))
> ggplot(data=finedust_without_na$re_china_average, aes(x=year, y=finedust, group=finedust_without_na$year))+ geom_line()
ggplot(data=finedust_without_na$re_china_average, aes(x=year, y=finedust, group=finedust_without_na$year))+ geom_line()
ggplot(data=finedust_without_na$re_china_average, aes(x=year, y=finedust, group=finedust_without_na$year))geom_line()
ggplot(data=finedust_without_na$re_china_average, aes(x=year, y=finedust, group=finedust_without_na$year)) geom_line()
ggplot(data=finedust_without_na$re_china_average, aes(x=year, y=finedust, group=finedust_without_na$year)) + geom_line()
ggplot(data=finedust_without_na$re_china_average, aes(x="year", y="finedust", group=finedust_without_na$year)) + geom_line()
ggplot(data = finedust_without_na$re_china_average, aes(x = year, y = finedust, group = year, colour = year)) +
geom_line()
finedust_without_na <- na.omit(finedust_without_na)
ggplot(data = finedust_without_na$re_china_average, aes(x = year, y = finedust, group = year, colour = year)) + geom_line()
# correlation analysis
finedust_without_na <- na.omit(finedust)
sum(is.na(finedust_without_na))
cor(finedust$china_average, finedust$seoul_average, method=c("pearson"), use=("complete.obs"))
# pearson without NA
# found chinese and korean fine dust are realated / 0.3687623
# find outlier
plot(finedust_without_na$china_average, finedust_without_na$seoul_average)
# remove outlier
boxplot(finedust_without_na$china_average, finedust_without_na$seoul_average)$stats # return statistic on boxplot
table(finedust_without_na$china_average)
finedust_without_na$re_china_average <- r_outlier <- ifelse(finedust_without_na$china_average < 13.61111 | finedust_without_na$china_average > 174.27778, NA, finedust_without_na$china_average)
finedust_without_na$re_seoul_average <- ifelse(finedust_without_na$seoul_average < 5 | finedust_without_na$seoul_average > 98, NA, finedust_without_na$seoul_average)
boxplot(finedust_without_na$re_china_average, finedust_without_na$re_seoul_average)
plot(finedust_without_na$re_china_average, finedust_without_na$re_seoul_average)
# visualization(finedust_with_na로 활용) -> too many x values
plot(finedust_without_na$re_china_average, type='o', col='red', ylim=c(1, 200), xlab='date', ylab='fine dust', main='graph for fine dust over 7 years')
lines(finedust_without_na$re_seoul_average, type='o', col='blue')
# visualization
finedust_without_na$date <- as.Date(finedust_without_na$date, format="%Y/%m/%d") # change string to date
library('lubridate')
finedust_without_na$year <- year(finedust_without_na$date)
finedust_without_na$month <- month(finedust_without_na$date)
library('ggplot2')
ggplot(data = finedust_without_na$re_china_average, aes(x = year, y = finedust, group = year, colour = year)) + geom_line()
finedust_v <- data.frame(finedust_without_na$year, finedust_without_na$month, finedust_without_na$re_china_average, finedust_without_na$re_seoul_average)
ggplot(data=finedust_v, aes(x="year", y="finedust", group=year)) + geom_line()
View(finedust_v)
colnames(finedust_v) <- c("year", "month", "re_china_average", "re_seoul_average")
finedust_v$year <- format(finedust_v$year, format=%Y)
finedust_v$year <- format(finedust_v$year, format="%Y")
ggplot(data=finedust_v, aes(x="year", y="finedust", group=year)) + geom_line()
ggplot(data=finedust_v, aes(x="year", y="finedust", group=year, color=year)) + geom_line()
ggplot(data=finedust_v, aes(x="year", y="finedust", group=year) + geom_line()
ggplot(data=finedust_v, aes(x="year", y="finedust", group=year)) + geom_line()
ggplot(data=finedust_v, aes(x="year", y="finedust", group=year)) + geom_line(size=1.3)
ggplot(data=finedust_v, aes(x="year", y="finedust", ylin = (1,200), group=year)) + geom_line(size=1.3)
ggplot(data=finedust_v, aes(x="year", y="finedust", ylin = (1,200), group=year)) + geom_line(size=1.3)
ggplot(data=finedust_v, aes(x="year", y="finedust", ylinm = (1,200), group=year)) + geom_line(size=1.3)
finedust_v$month <- format(finedust_v$month, format="%m")
ggplot(data=finedust_v, aes(x="year", y="finedust", ylinm = (1,200), group=year)) + geom_line(size=1.3)
finedust_g <- finedust_v %>% group_by(year, month) %>% tally
finedust_g <- group_by(year, month)
ddply(finedust_v, .(year), transform, average = mean(finedust_v$re_china_average))
install.packages("ddply")
ddply(finedust_v, .(year), transform, average = mean(finedust_v$re_china_average))
aggregate(finedust_v[c('re_china_average', 're_seoul_average')], by=yaer & month, mean)
aggregate(finedust_v[c('re_china_average', 're_seoul_average')], by=finedust_v$yaer & finedust_v$month, mean)
aggregate(finedust_v[c('re_china_average', 're_seoul_average')], by=finedust_v$yaer && finedust_v$month, mean)
aggregate(finedust_v[c('re_china_average', 're_seoul_average')], by=finedust_v$year, mean)
aggregate(finedust_v[c('re_china_average', 're_seoul_average')], by=list(finedust_v$year), mean)
aggregate(finedust_v[c('re_china_average', 're_seoul_average')], by=list(year), mean)
finedust_v <- na.omit(finedust_v)
aggregate(finedust_v[c('re_china_average', 're_seoul_average')], by=list(year), mean)
aggregate(finedust_v[c('re_china_average', 're_seoul_average')], by=list(finedust_v$year), mean)
year_average <- aggregate(finedust_v[c('re_china_average', 're_seoul_average')], by=list(finedust_v$year), mean)
ggplot(data=year_average, aes(x="year", y="finedust", group=year)) + geom_line()
View(year_average)
ggplot(data=year_average$re_china_average, aes(x="year", y="finedust", group=year)) + geom_line()
ggplot(data=year_average, aes(x="year", y="finedust", group=year)) + geom_line()
c_year_average <- aggregate(finedust_v$re_china_average[c('re_china_average')], by=list(finedust_v$year), mean)
c_year_average <- aggregate(finedust_v$re_china_average[c('re_china_average')], by=list(year), mean)
c_year_average <- aggregate(finedust_v[c('re_china_average', 're_seoul_average')], by=list(finedust_v$year), mean)
View(c_year_average)
rm(year_average)
c_year_average <- c_year_average[, c(-3)]
ggplot(data=year_average, aes(x="year", y="finedust", group=year)) + geom_line()
ggplot(data=c_year_average, aes(x="year", y="finedust", group=year)) + geom_line()
c_year_average <- aggregate(finedust_v[c('re_china_average', 're_seoul_average')], by=list(finedust_v$year), mean)
ggplot(data=c_year_average, aes(x="year", y="finedust", group=year)) + geom_line()
View(c_year_average)
c_year_average <- aggregate(finedust_v[c('re_china_average', 're_seoul_average')], by=list(finedust_v$year, finedust_v$month), mean)
ggplot(data=c_year_average, aes(x="year", y="finedust", group=year)) + geom_line()
library('ggplot2')
ggplot(data=c_year_average, aes(x="year", y="finedust", group=year)) + geom_line()
ggplot(data=c_year_average, aes(x="year", y="finedust")) + geom_line()
ggplot(data=c_year_average, aes(x="year", y="finedust", main="analysis for finedust over 7 years")) + geom_line()
ggplot(data=c_year_average)
ggplot(c_year_average)
ggplot(c_year_average, aes(x="year", y="finedust", main="analysis for finedust over 7 years")) + geom_line()
plot(c_year_average, type='o', col='read, ylim=c(1,120))
plot(c_year_average, type='o', col='read', ylim=c(1,120))
plot(c_year_average, type='o', col='red', ylim=c(1,120))
plot(c_year_average$re_china_average, type='o', col='red', ylim=c(1,120))
plot(c_year_average$re_china_average, type='o', col='red', ylim=c(1,120), xlab='date', ylab='finedust', main='Chinese & Korean finedaust for 7 year')
lines(c_year_average$re_seoul_average, type='o', col='blue')
plot(c_year_average$re_china_average, type='o', col='red', ylim=c(1,130), xlab='date', ylab='finedust', main='Chinese & Korean finedaust for 7 year')
lines(c_year_average$re_seoul_average, type='o', col='blue')
library(dplyr)
install.packages('dplyr')
library('dplyr')
finedust_v <- data.frame(finedust_without_na$year, finedust_without_na$month, finedust_without_na$re_china_average, finedust_without_na$re_seoul_average)
colnames(finedust_v) <- c("year", "month", "re_china_average", "re_seoul_average")
finedust_v$year <- format(finedust_v$year, format="%Y") # change year to string
finedust_v$month <- format(finedust_v$month, format="%m")
finedust_v <- na.omit(finedust_v)
c_year_average <- aggregate(finedust_v[c('re_china_average', 're_seoul_average')], by=list(finedust_v$year, finedust_v$month), mean)
install.packages('dplyr')
ggplot(c_year_average[c_year_average$Group.1 %in% c(1,4),],), aes(x=year, y=c_year_average$re_china_average, group=month())
ggplot(c_year_average[c_year_average$Group.1 %in% c(1,4),], aes(x=year, y=c_year_average$re_china_average, group=Group.2)
geom_line()
ggplot(c_year_average[c_year_average$Group.1 %in% c(1,4),], aes(x=year, y=c_year_average$re_china_average, group=Group.2) + geom_line()
plot(c_year_average$re_china_average, type='o', col='red', ylim=c(1,130), xlab='date', ylab='finedust', main='Chinese & Korean finedaust for 7 year')
ggplot(c_year_average[c_year_average$Group.1 %in% c(1,4),], aes(x=year, y=c_year_average$re_china_average, group=Group.2))
ggplot(c_year_average[c_year_average$Group.1 %in% c(1,4),], aes(x=year, y=c_year_average$re_china_average, group=Group.2)) + geom_lime()
ggplot(c_year_average[c_year_average$Group.1 %in% c(1,4),], aes(x=year, y=c_year_average$re_china_average, group=Group.2)) + geom_line()
ggplot(c_year_average[c_year_average$Group.1 %in% c(1,4),], aes(x=GROUP.1, y=c_year_average$re_china_average, group=Group.2)) + geom_line()
colnames(c_year_average) <- c("year", "month", "re_china_average", "re_seoul_average")
ggplot(c_year_average[c_year_average$month %in% c(1,4),], aes(x=year, y=c_year_average$re_china_average, group=month) + geom_line()
ggplot(c_year_average[c_year_average$month %in% c(1,4),], aes(x=year, y=c_year_average$re_china_average, group=month)) + geom_line()
ggplot(c_year_average[c_year_average$month %in% c(1,4),], aes(x=year, y=c_year_average$re_china_average, group=month)) + geom_line()
ggplot(c_year_average[c_year_average$month %in% c(1,4),], aes(x=month, y=c_year_average$re_china_average, group=month)) + geom_line()
ggplot(c_year_average[c_year_average$month %in% c(1,4),], aes(x=year, y=c_year_average$re_china_average, group=month)) + geom_line()
library('dplyr')
library('ggplot2')
library('dplyr')
install.packages('dplyr')
library('dplyr')
install.packages("dplyr")
library('dplyr')
ggplot(c_year_average[c_year_average$month %in% c(1,4),], aes(x=year, y=c_year_average$re_china_average, group=month)) + geom_line()
c_year_average%>%
ggplot(aes(c_year_average$year, c_year_average$re_china_average)) +
geom_line()
c_year_average%>%
ggplot(aes(year, re_china_average)) +
geom_line()
ggplot(c_year_average[c_year_average$month %in% c(1,4),], aes(x=year, y=c_year_average$re_china_average, group=month)) + geom_line()
ggplot(c_year_average)
ggplot(c_year_average) + geom_line()
ggplot(c_year_average, aes(year, re_china_average, color = seven)) + geom_line()
ggplot(c_year_average, aes(year, re_china_average, color = year)) + geom_line()
ggplot(c_year_average, aes(month, re_china_average, color = year)) + geom_line()
ggplot(c_year_average, aes(month, re_china_average, color = month)) + geom_line()
ggplot(c_year_average, aes(month, re_china_average, group = month, color = month)) + geom_line()
View(finedust_v)
ggplot(finedust_v, aes(month, re_china_average, group = month, color = month)) + geom_line()
ggplot(finedust_v, aes(month, re_china_average, group = month, color = month)) + geom_line() +ggtitle("finedust over 7 years")
ggplot(finedust_v, aes(month, re_china_average, group = 1, color = month)) + geom_line() +ggtitle("finedust over 7 years")
ggplot(finedust_v, aes(month, re_china_average, group = 2, color = month)) + geom_line() +ggtitle("finedust over 7 years")
ggplot(finedust_v, aes(month, re_china_average, group = month, color = month)) + geom_line() +ggtitle("finedust over 7 years")
ggplot(finedust_v, aes(month, finedust, group = month, color = month)) + geom_line() +ggtitle("finedust over 7 years")
ggplot(finedust_v, aes(month, re_seoul_average, group = month, color = month)) + geom_line() +ggtitle("finedust over 7 years")
ggplot(finedust_v, aes(month, re_seoul_average, group = year&month, color = month)) + geom_line() +ggtitle("finedust over 7 years")
ggplot(finedust_v, aes(month, re_seoul_average, group = year&&month, color = month)) + geom_line() +ggtitle("finedust over 7 years")
ggplot(finedust_v, aes(month, re_seoul_average, group = year, month, color = month)) + geom_line() +ggtitle("finedust over 7 years")
ggplot(finedust_v, aes(month, re_seoul_average, group = c(year, month), color = month)) + geom_line() +ggtitle("finedust over 7 years")
ggplot(finedust_v, aes(month, re_seoul_average, group = month, color = month)) + geom_line() +ggtitle("finedust over 7 years")
ggplot(finedust_v, aes(month, re_seoul_average, group = month, color = month)) + geom_line() +ggtitle("Finedust over 7 years")
c_year_average <- finedust_v %>%
group_by(year, re_china_average) %>%
tally
ggplot(c_year_average, aes(year,re_china_average)) + geom_line()
ggplot(c_year_average, aes(year,re_china_average)) + geom_line() +ggtitle("Finedust over 7 years")
ggplot(c_year_average, aes(year, n)) + geom_line() +ggtitle("Finedust over 7 years")
ggplot(c_year_average, aes(year, re_china_average, color = year)) + geom_line() +ggtitle("Finedust over 7 years")
c_year_average <- aggregate(finedust_v[c('re_china_average', 're_seoul_average')], by=list(finedust_v$year), mean)
ggplot(c_year_average, aes(year, re_china_average, color = year)) + geom_line() +ggtitle("Finedust over 7 years")
colnames(c_year_average) <- c("year", "re_china_average", "re_seoul_average")
ggplot(c_year_average, aes(year, re_china_average, color = year)) + geom_line() +ggtitle("Finedust over 7 years")
ggplot(c_year_average) + geom_line()
ggplot(c_year_average, aes(year, re_china_average, color = year)) + geom_line() +ggtitle("Finedust over 7 years")
ggplot(c_year_average, aes(year, re_china_average, group = 1, color = year)) + geom_line() +ggtitle("Finedust over 7 years")
+geom_line(aex(year, re_seoul_average, group = 1, color='red'))
+geom_line(aes(year, re_seoul_average, group = 1, color='red'))
c_year_average <- aggregate(finedust_v[c('re_china_average', 're_seoul_average')], by=list(finedust_v$year, finedust_v$month), mean)
colnames(c_year_average) <- c("year", "month", "re_china_average", "re_seoul_average")
ggplot(c_year_average, aes(year, re_china_average, group = 1, color = "red")) + geom_line() +ggtitle("Finedust over 7 years")
ggplot(c_year_average, aes(year, re_china_average, group = 1, color = year)) + geom_line() +ggtitle("Finedust over 7 years")
c_year_average <- aggregate(finedust_v[c('re_china_average', 're_seoul_average')], by=list(finedust_v$year), mean)
colnames(c_year_average) <- c("year", "re_china_average", "re_seoul_average")
ggplot(c_year_average, aes(year, re_china_average, color = year)) + geom_line() +ggtitle("Finedust over 7 years")
ggplot(c_year_average, aes(year, re_china_average, group = 1, color = year)) + geom_line() +ggtitle("Finedust over 7 years")
gg+geom-line(aes(year, re_seoul_average, color=year))
gg <- ggplot(c_year_average, aes(year, re_china_average, group = 1, color = year)) + geom_line() +ggtitle("Finedust over 7 years")
gg+geom-line(aes(year, re_seoul_average, color=year))
gg+geom_line(aes(year, re_seoul_average, color=year))
gg <- ggplot(c_year_average, aes(year, re_china_average, group = 1)) + geom_line(color = 'red') +ggtitle("Finedust over 7 years")
gg+geom_line(aes(year, re_seoul_average), color = 'blue')
gg+geom_line(aes(year, re_seoul_average), color = 'blue') + theme(legend.title = "Countries")
gg <- ggplot(c_year_average, aes(year, re_china_average, group = 1)) + geom_line(color = 'red') +ggtitle("Finedust over 7 years")
gg+geom_line(aes(year, re_seoul_average), color = 'blue')
gg <- ggplot(c_year_average, aes(year, re_china_average, group = 1)) + geom_line(color = 'red') +ggtitle("Finedust over 7 years") + ylab('finedust')
gg+geom_line(aes(year, re_seoul_average), color = 'blue')
c_year_average <- aggregate(finedust_v[c('re_china_average', 're_seoul_average')], by=list(finedust_v$year, finedust_v$month), mean)
colnames(c_year_average) <- c("year", "month", "re_china_average", "re_seoul_average")
gg <- ggplot(c_year_average, aes(year, re_china_average, group = 1)) + geom_line(color = 'red') +ggtitle("Finedust over 7 years") + ylab('finedust')
gg+geom_line(aes(year, re_seoul_average), color = 'blue')
c_year_average <- aggregate(finedust_v[c('re_china_average', 're_seoul_average')], by=list(finedust_v$year), mean)
colnames(c_year_average) <- c("year", "re_china_average", "re_seoul_average")
gg <- ggplot(c_year_average, aes(year, re_china_average, group = 1)) + geom_line(color = 'red') +ggtitle("Finedust over 7 years") + ylab('finedust')
gg+geom_line(aes(year, re_seoul_average), color = 'blue')
gg2+geom_line(aes(year, re_seoul_average), color = 'blue')
gg2 <- ggplot(c_year_average, aes(year, re_china_average, group = 1)) + geom_line(color = 'red') +ggtitle("Finedust over 7 years") + ylab('finedust')
gg2+geom_line(aes(year, re_seoul_average), color = 'blue')
rm(gg)
c_year_average <- aggregate(finedust_v[c('re_china_average', 're_seoul_average')], by=list(finedust_v$year, finedust_v$month), mean)
colnames(c_year_average) <- c("year", "month", "re_china_average", "re_seoul_average")
gg1 <- ggplot(c_year_average, aes(year, re_china_average, group = 1)) + geom_line(color = 'red') +ggtitle("Finedust over 7 years") + ylab('finedust')
gg1 +geom_line(aes(year, re_seoul_average), color = 'blue')
gg1 <- ggplot(c_year_average, aes(year, re_china_average)) + geom_line(color = 'red') +ggtitle("Finedust over 7 years") + ylab('finedust')
gg1 +geom_line(aes(year, re_seoul_average), color = 'blue')
gg1 <- ggplot(c_year_average, aes(year, re_china_average)) + geom_line(color = 'red') +ggtitle("Finedust over 7 years") + ylab('finedust') + facet_wrap(~month)
gg1 +geom_line(aes(year, re_seoul_average), color = 'blue')
gg1 <- ggplot(c_year_average, aes(year, re_china_average)) + geom_line(color = 'red') +ggtitle("Finedust over 7 years") + ylab('finedust') + facet_wrap(~month[1,4])
gg1 +geom_line(aes(year, re_seoul_average), color = 'blue')
gg1 <- ggplot(c_year_average, aes(year, re_china_average)) + geom_line(color = 'red') +ggtitle("Finedust over 7 years") + ylab('finedust') + facet_wrap(~month[1 :4])
gg1 +geom_line(aes(year, re_seoul_average), color = 'blue')
gg1 <- ggplot(c_year_average, aes(year, re_china_average)) + geom_line(color = 'red') +ggtitle("Finedust over 7 years") + ylab('finedust') + facet_wrap(~month==(1,4))
gg1 <- ggplot(c_year_average, aes(year, re_china_average)) + geom_line(color = 'red') +ggtitle("Finedust over 7 years") + ylab('finedust')
gg1 +geom_line(aes(year, re_seoul_average), color = 'blue')
gg1 +geom_line(aes(year, re_seoul_average), color = 'blue') + scale_color_discrete(name="countries")
gg1 <- ggplot(c_year_average, aes(year, re_china_average, color = re_china_average)) + geom_line(color = 'red') +ggtitle("Finedust over 7 years") + ylab('finedust')
gg1 + geom_line(aes(year, re_seoul_average), color = 'blue') + scale_color_discrete(name="countries")
gg1 <- ggplot(c_year_average, aes(year, re_china_average, color = re_china_average)) + geom_line() +ggtitle("Finedust over 7 years") + ylab('finedust')
gg1 + geom_line(aes(year, re_seoul_average), color = 'blue') + scale_color_discrete(name="countries")
gg1 + geom_line(aes(year, re_seoul_average), color = 'blue')
gg1 <- ggplot(c_year_average, aes(year, re_china_average, group = re_china_average)) + geom_line() +ggtitle("Finedust over 7 years") + ylab('finedust')
gg1 + geom_line(aes(year, re_seoul_average), color = 'blue')
gg1 <- ggplot(c_year_average, aes(year, re_china_average)) + geom_line(color = 'red') +ggtitle("Finedust over 7 years") + ylab('finedust')
gg1 + geom_line(aes(year, re_seoul_average), color = 'blue')
# annal line graph  ----------------------------------
c_year_average <- aggregate(finedust_v[c('re_china_average', 're_seoul_average')], by=list(finedust_v$year), mean)
colnames(c_year_average) <- c("year", "re_china_average", "re_seoul_average")
gg2 <- ggplot(c_year_average, aes(year, re_china_average, group = 1)) + geom_line(color = 'red') +ggtitle("Finedust over 7 years") + ylab('finedust')
gg2+geom_line(aes(year, re_seoul_average), color = 'blue')
gg2+geom_line(aes(year, re_seoul_average), color = 'blue') + geom_text(x=2014, y=100, label = china, color = 'black')
gg2+geom_line(aes(year, re_seoul_average), color = 'blue') + geom_text(x=2014, y=100, label = 'china', color = 'black')
gg2 <- ggplot(c_year_average, aes(year, re_china_average, group = 1)) + geom_line(color = 'red') +ggtitle("Finedust over 7 years") + ylab('finedust') + geom_text(x=2014, y=100, label = 'china', color = 'black')
gg2+geom_line(aes(year, re_seoul_average), color = 'blue')
gg2 <- ggplot(c_year_average, aes(year, re_china_average, group = 1)) + geom_line(color = 'red') + ggtitle("Finedust over 7 years") + ylab('finedust') + geom_text(x=2014, y=100, label = 'china', color = 'black', size=5)
gg2+geom_line(aes(year, re_seoul_average), color = 'blue')
gg2+geom_line(aes(year, re_seoul_average), color = 'blue') + geom_text(x=2014, y=50, label = 'korea', color = 'black', size=5)
gg2 <- ggplot(c_year_average, aes(year, re_china_average, group = 1)) + geom_line(color = 'red') + ggtitle("Finedust over 7 years") + ylab('finedust') + geom_text(x=2014, y=100, label = 'china', color = 'black', size=5)
gg2+geom_line(aes(year, re_seoul_average), color = 'blue') + geom_text(x=2014, y=50, label = 'korea', color = 'black', size=5)
gg2 <- ggplot(c_year_average, aes(year, re_china_average, group = 1)) + geom_line(color = 'red') + ggtitle("Finedust over 7 years") + ylab('finedust')
gg2+geom_line(aes(year, re_seoul_average), color = 'blue')
gg2 <- ggplot(c_year_average, aes(year, re_china_average, group = 1)) + geom_line(color = 'red') + ggtitle("Finedust over 7 years") + ylab('finedust') + theme(plot.title = element_text(size = 35, hjust=0.5))
gg2+geom_line(aes(year, re_seoul_average), color = 'blue')
gg2 <- ggplot(c_year_average, aes(year, re_china_average, group = 1)) + geom_line(color = 'red') + ggtitle("Finedust over 7 years") + ylab('finedust') + theme(plot.title = element_text(size = 10, hjust=0.5))
gg2+geom_line(aes(year, re_seoul_average), color = 'blue')
gg2 <- ggplot(c_year_average, aes(year, re_china_average, group = 1)) + geom_line(color = 'red') + ggtitle("Finedust over 7 years") + ylab('finedust') + theme(plot.title = element_text(size = 15, hjust=0.5))
gg2+geom_line(aes(year, re_seoul_average), color = 'blue')
finedust_v %>%
group_by(year,month) %>%
summarize(group_c = mean(re_china_average))
finedust_v %>%
group_by(year,month) %>%
summarize(group_c = mean(re_china_average), group_s = mean(re_seoul_average))
c_year_average <- finedust_v %>%
group_by(year,month) %>%
summarize(group_c = mean(re_china_average), group_s = mean(re_seoul_average))
gg1 + geom_line(aes(year, group_s), color = 'blue')
gg1 <- ggplot(c_year_average, aes(year, group_c)) + geom_line(color = 'red') +ggtitle("Finedust over 7 years") + ylab('finedust')
gg1 + geom_line(aes(year, group_s), color = 'blue')
# annal line graph  ----------------------------------
c_year_average <- finedust_v %>%
group_by(year) %>%
summarize(group_c = mean(re_china_average), group_s = mean(re_seoul_average))
colnames(c_year_average) <- c("year", "re_china_average", "re_seoul_average")
# annal line graph  ----------------------------------
c_year_average <- finedust_v %>%
group_by(year) %>%
summarize(group_c = mean(re_china_average), group_s = mean(re_seoul_average))
gg2 <- ggplot(c_year_average, aes(year, re_china_average, group = 1)) + geom_line(color = 'red') + ggtitle("Finedust over 7 years") + ylab('finedust') + theme(plot.title = element_text(size = 15, hjust=0.5))
gg2+geom_line(aes(year, re_seoul_average), color = 'blue')
gg2 <- ggplot(c_year_average, aes(year, group_c, group = 1)) + geom_line(color = 'red') + ggtitle("Finedust over 7 years") + ylab('finedust') + theme(plot.title = element_text(size = 15, hjust=0.5))
gg2+geom_line(aes(year, group_s), color = 'blue')
finedust_d <- finedust_v %>%
group_by(year,month) %>%
summarize(group_c = mean(re_china_average), group_s = mean(re_seoul_average))
View(finedust_d)
finedust_d <- finedust_d[grep("1", "2", "3", "4", finedust_d$month),]
finedust_d <- finedust_v %>%
group_by(year,month) %>%
summarize(group_c = mean(re_china_average), group_s = mean(re_seoul_average))
finedust_d <- finedust_d[!(finedust_d$month == '5'), ]
View(finedust_d)
finedust_d <- finedust_d[!(finedust_d$month == '5'), ]
finedust_d <- finedust_d[!(finedust_d$month == '6'), ]
finedust_d <- finedust_d[!(finedust_d$month > '4'), ]
finedust_d <- finedust_d[!(finedust_d$month > 4), ]
finedust_d <- finedust_d[!(finedust_d$month > 4), ]
finedust_d <- finedust_d[finedust_d$month > 5,]
finedust_d <- finedust_v %>%
group_by(year,month) %>%
summarize(group_c = mean(re_china_average), group_s = mean(re_seoul_average))
finedust_d <- finedust_d[finedust_d$month < 5,]
finedust_d <- finedust_d[finedust_d$month < 5,]
View(finedust_d)
finedust_d <- finedust_v %>%
group_by(year,month) %>%
summarize(group_c = mean(re_china_average), group_s = mean(re_seoul_average))
finedust_d <- finedust_d[finedust_d$month < 5,]
finedust_d[finedust_d$month < 5,]
finedust_d[!(finedust_d$month < 5),]
finedust_d <- finedust_d[!(finedust_d$month < 5),]
finedust_d <- finedust_v %>%
group_by(year,month) %>%
summarize(group_c = mean(re_china_average), group_s = mean(re_seoul_average))
finedust_d <- finedust_d[(finedust_d$month < 5),]
finedust_d <- finedust_d[!(finedust_d$month > 5),]
finedust_d <- finedust_d[-grep("5", finedust_d$month),]
finedust_d <- finedust_d[-grep("6", finedust_d$month),]
finedust_d <- finedust_d[-grep("7", finedust_d$month),]
finedust_d <- finedust_d[-grep("8", finedust_d$month),]
finedust_d <- finedust_d[-grep("9", finedust_d$month),]
finedust_d <- finedust_d[-grep("10", finedust_d$month),]
finedust_d <- finedust_d[-grep("11", finedust_d$month),]
finedust_d <- finedust_d[-grep("12", finedust_d$month),]
finedust_d <- paste(finedust_d$year, finedust_d$month)
finedust_d <- finedust_v %>%
group_by(year,month) %>%
summarize(group_c = mean(re_china_average), group_s = mean(re_seoul_average))
finedust_d <- finedust_d[-grep("5", finedust_d$month),]
finedust_d <- finedust_d[-grep("6", finedust_d$month),]
finedust_d <- finedust_d[-grep("7", finedust_d$month),]
finedust_d <- finedust_d[-grep("8", finedust_d$month),]
finedust_d <- finedust_d[-grep("9", finedust_d$month),]
finedust_d <- finedust_d[-grep("10", finedust_d$month),]
finedust_d <- finedust_d[-grep("11", finedust_d$month),]
finedust_d <- finedust_d[-grep("12", finedust_d$month),]
finedust_d$year_month <- paste(finedust_d$year, finedust_d$month)
ggplot(finedust_d, aes(x=year_month, y=group_c) group=interaction(year, month)) + geom_line()
ggplot(finedust_d, aes(x=year_month, y=group_c, group=interaction(year, month))) + geom_line()
ggplot(finedust_d, aes(x=year_month, y=group_c, group=1)) + geom_line()
ggplot(finedust_d, aes(x=year, y=group_c, group=1)) + geom_line()
ggplot(finedust_d, aes(x=year, y=group_c, group=year)) + geom_line()
ggplot(finedust_d, aes(x=year, y=group_c, group=interaction(year, month)) + geom_line()
ggplot(finedust_d, aes(x=year, y=group_c, group=interaction(year, month))) + geom_line()
ggplot(finedust_d, aes(x=year, y='finedust', shape = group_c, colour = group_s))+geom_line(aes(group=interaction(group_c, group_s))) + geom_line()
finedust_d <- finedust_d %>%
group_by(year) %>%
summarize(group_c = mean(re_china_average), group_s = mean(re_seoul_average))
finedust_d <- finedust_d %>%
group_by(year) %>%
summarize(group_c = mean(group_c), group_s = mean(group_s))
gg3 <- ggplot(finedust_d, aes(year, group_c, group = 1)) + geom_line(color = 'red') + ggtitle("Finedust from Jan to Apr") + ylab('finedust') + theme(plot.title = element_text(size = 15, hjust=0.5))
gg3+geom_line(aes(year, group_s), color = 'blue')
gg3 <- ggplot(finedust_d, aes(year, group_c, group = 1)) + geom_line(color = 'red') + ggtitle("Finedust from Jan to Apr") + ylab('finedust') + theme(plot.title = element_text(size = 15, hjust=0.5))
gg3 <- gg3+geom_line(aes(year, group_s), color = 'blue')
gg3
gg2 <- ggplot(c_year_average, aes(year, group_c, group = 1)) + geom_line(color = 'red') + ggtitle("Finedust over 7 years") + ylab('finedust') + theme(plot.title = element_text(size = 15, hjust=0.5))
gg2 <- gg2+geom_line(aes(year, group_s), color = 'blue')
gg2
grid.arrange(gg2, gg3, ncol=2)
install.packages('gridExtra')
library('gridExtra')
grid.arrange(gg2, gg3, ncol=2)
gg3
gg2
# open csv
beijing <- read.csv(file="C:\Users\Hyejin\Desktop\File\University\Capstone1\project\website\hyejin\preprocessed data\beijing-air-quality.csv", header=T)
# open csv
beijing <- read.csv(file="./preprocessed data/beijing-air-quality.csv", header=T)
